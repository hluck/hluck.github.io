<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hluck.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="纸上得来终觉浅，绝知此事要躬行。">
<meta property="og:type" content="website">
<meta property="og:title" content="余一">
<meta property="og:url" content="https://hluck.github.io/page/10/index.html">
<meta property="og:site_name" content="余一">
<meta property="og:description" content="纸上得来终觉浅，绝知此事要躬行。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="余一">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://hluck.github.io/page/10/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>余一</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="余一" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">余一</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">纸上得来终觉浅，绝知此事要躬行。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/11/06/Redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/06/Redis/" class="post-title-link" itemprop="url">Redis</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-06 10:23:32" itemprop="dateCreated datePublished" datetime="2021-11-06T10:23:32+08:00">2021-11-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-14 10:51:41" itemprop="dateModified" datetime="2021-11-14T10:51:41+08:00">2021-11-14</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>11k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>10 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><h2 id="Redis环境搭建与数据结构原理"><a href="#Redis环境搭建与数据结构原理" class="headerlink" title="Redis环境搭建与数据结构原理"></a>Redis环境搭建与数据结构原理</h2><h3 id="Redis缓存框架基本介绍"><a href="#Redis缓存框架基本介绍" class="headerlink" title="Redis缓存框架基本介绍"></a>Redis缓存框架基本介绍</h3><p>Redis是完全开源免费的，是一个高性能的key-value数据库，目前市面上主流的非关系型数据库Redis,Memcache,Tair(淘宝自研发)</p>
<p>关系数据库存放在硬盘中，查询实现io操作</p>
<h3 id="Redis应用场景"><a href="#Redis应用场景" class="headerlink" title="Redis应用场景"></a>Redis应用场景</h3><ol>
<li><p>Token令牌生成</p>
</li>
<li><p>短信验证码的code</p>
</li>
<li><p>可以实现缓存查询数据</p>
</li>
<li><p>Redis帮助实现计数器</p>
</li>
<li><p>分布式锁</p>
</li>
<li><p>延迟操作</p>
<p>减轻数据库的访问压力</p>
</li>
</ol>
<h3 id="Redis线程模型IO多路复用"><a href="#Redis线程模型IO多路复用" class="headerlink" title="Redis线程模型IO多路复用"></a>Redis线程模型IO多路复用</h3><h4 id="Redis单线程模型"><a href="#Redis单线程模型" class="headerlink" title="Redis单线程模型"></a>Redis单线程模型</h4><p>首先Redis官方是没有windows版本的，只有linux版本</p>
<p>Redis底层采用Nio中的多路IO复用原则，能够很好的支持并发，从而保证线程安全问题。</p>
<p><strong>Redis单线程，也就是底层采用一个线程维护多个不同的客户端io操作。</strong></p>
<p>为什么nginx、redis都能够非常高的支持高并发，最终都是linux中的IO多路复用机制epoll.</p>
<p>Redis底层采用 nio epoll实现</p>
<p><a href="https://blog.csdn.net/qq_36520235/article/details/81318189" target="_blank" rel="noopener">什么是NIO?</a></p>
<h3 id="Redis前台启动环境安装"><a href="#Redis前台启动环境安装" class="headerlink" title="Redis前台启动环境安装"></a>Redis前台启动环境安装</h3><h4 id="1-环境安装Redis"><a href="#1-环境安装Redis" class="headerlink" title="1.环境安装Redis"></a>1.环境安装Redis</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.上传Redis的安装包</span><br><span class="line">redis-<span class="number">5.0</span><span class="number">.6</span>.tar.gz</span><br><span class="line"><span class="number">2</span>.解压我们的Redis安装包</span><br><span class="line">tar -zxvf redis-<span class="number">5.0</span><span class="number">.6</span>.tar.gz</span><br><span class="line"><span class="number">3</span>. mkdir/usr/redis</span><br><span class="line"><span class="number">4</span>.make install PREFIX = /usr/redis</span><br><span class="line"><span class="number">5</span>.启动Redis cd/usr/redis/bin   ./redis-server</span><br></pre></td></tr></table></figure>

<h3 id="Redis设置允许外界访问"><a href="#Redis设置允许外界访问" class="headerlink" title="Redis设置允许外界访问"></a>Redis设置允许外界访问</h3><h4 id="1-将Redis设置为后台启动"><a href="#1-将Redis设置为后台启动" class="headerlink" title="1.将Redis设置为后台启动"></a>1.将Redis设置为后台启动</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/redis-<span class="number">5.0</span><span class="number">.6</span>/redis.conf  /usr/redis/bin</span><br><span class="line">vi redis.conf daemonize yes</span><br><span class="line">ps aux | grep <span class="string">'redis'</span>      kill -<span class="number">9</span> <span class="number">7178</span></span><br><span class="line">./redis-server  redis-conf  重新启动redis</span><br></pre></td></tr></table></figure>

<h4 id="2-设置Redis帐号密码"><a href="#2-设置Redis帐号密码" class="headerlink" title="2.设置Redis帐号密码"></a>2.设置Redis帐号密码</h4><p>redis.conf配置文件搜索(vi进入配置文件输入  / 搜索文本)：# requirepass foobared      requirepass  123456</p>
<h4 id="3-设置Redis允许ip访问"><a href="#3-设置Redis允许ip访问" class="headerlink" title="3.设置Redis允许ip访问"></a>3.设置Redis允许ip访问</h4><p>注释掉 bind 127.0.0.1</p>
<p>protected-mode no  ###允许外界访问</p>
<p>systemctl stop firewalld   ### 关闭防火墙</p>
<p><strong>Redis默认情况下分为16个库(0-15)</strong></p>
<h3 id="Redis的五种数据类型"><a href="#Redis的五种数据类型" class="headerlink" title="Redis的五种数据类型"></a>Redis的五种数据类型</h3><h4 id="1-String类型"><a href="#1-String类型" class="headerlink" title="1.String类型"></a>1.String类型</h4><p>​        String是redis最基本的类型，一个key对应一个value，sring类型是二进制安全的。意思是redis的string可以包含任何数据。比如jpg图片或者序列化的对象, Sring类型是Redis最基本的数据类型，一个键最大能存储512MB。</p>
<p>set name tom</p>
<p>get tom</p>
<h4 id="2-Hash类型"><a href="#2-Hash类型" class="headerlink" title="2.Hash类型"></a>2.Hash类型</h4><p>​       我们可以将Redis中的Hash类型看成具有&lt;key,&lt;key1,value&gt;&gt;,其中同一个key可以有多个不同key值的&lt;key1,value&gt;，所以该类型非常适合于存储值对象的信息。如Username、Password和Age等。如果Hash中包含很少的字段，那么该类型的数据也将仅占用很少的磁盘空间。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HMSET man_hash tom <span class="number">21</span> jom <span class="number">22</span> <span class="comment">//tom 21表示一个hash</span></span><br><span class="line">HGETALL man</span><br></pre></td></tr></table></figure>

<h4 id="3-List类型"><a href="#3-List类型" class="headerlink" title="3.List类型"></a>3.List类型</h4><p>Redis列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LPUSH namelist tom jack tony</span><br><span class="line">LRANGE namelist <span class="number">0</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>

<h4 id="4-Set集合"><a href="#4-Set集合" class="headerlink" title="4.Set集合"></a>4.Set集合</h4><p>Redis 的 Set 是 String 类型的无序集合。集合成员是唯一的，这就意味着集合中不能出现重复的数据。</p>
<p>Redis 中集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是 O(1)。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SADD nameset tom lucy jany owen</span><br><span class="line">SMEMBERS  nameset</span><br></pre></td></tr></table></figure>

<h4 id="5-有序集合-sorted-set"><a href="#5-有序集合-sorted-set" class="headerlink" title="5.有序集合(sorted  set)"></a>5.有序集合(sorted  set)</h4><p>Redis 有序集合和集合一样也是string类型元素的集合,且不允许重复的成员。</p>
<p>不同的是每个元素都会关联一个double类型的分数。redis正是通过分数来为集合中的成员进行从小到大的排序。</p>
<p>有序集合的成员是唯一的,但分数(score)却可以重复。</p>
<p>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。 集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ZADD mset <span class="number">1</span> redis</span><br><span class="line">ZRANGE mset2 <span class="number">0</span> <span class="number">10</span> WITHSCORES</span><br></pre></td></tr></table></figure>

<p>Redis如何存放一个java对象 直接存放json类型即可</p>
<p>Set key=user value=｛”userid”:100,”username”:yushengjun｝</p>
<p>Xxl-sso 底层如何存放对象 存放二进制</p>
<h3 id="SpringBoot整合Redis框架"><a href="#SpringBoot整合Redis框架" class="headerlink" title="SpringBoot整合Redis框架"></a>SpringBoot整合Redis框架</h3><p>在Redis存放一个对象 使用json序列化与反序列化</p>
<h4 id="1-maven依赖"><a href="#1-maven依赖" class="headerlink" title="1.maven依赖"></a>1.maven依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-boot.version</span>&gt;</span>2.3.7.RELEASE<span class="tag">&lt;/<span class="name">spring-boot.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 集成commons工具类 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang3<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- fastjson --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.30<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-Redis工具类-方式一"><a href="#2-Redis工具类-方式一" class="headerlink" title="2.Redis工具类(方式一)"></a>2.Redis工具类(方式一)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 余一</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/11/7  10:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setString</span><span class="params">(String key, String value)</span> </span>&#123;</span><br><span class="line">        setString(key, value, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setString</span><span class="params">(String key, String value, Long timeOut)</span> </span>&#123;</span><br><span class="line">        stringRedisTemplate.opsForValue().set(key, value);</span><br><span class="line">        <span class="keyword">if</span> (timeOut != <span class="keyword">null</span>) &#123;</span><br><span class="line">            stringRedisTemplate.expire(key, timeOut, TimeUnit.SECONDS);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getString</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stringRedisTemplate.opsForValue().get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2Redis工具类-方式二"><a href="#2-2Redis工具类-方式二" class="headerlink" title="2.2Redis工具类(方式二)"></a>2.2Redis工具类(方式二)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 余一</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/11/7  10:56</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisTemplateUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String,Object&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setObject</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">        setObject(key, value, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setObject</span><span class="params">(String key, Object value, Long timeOut)</span> </span>&#123;</span><br><span class="line">        redisTemplate.opsForValue().set(key, value);</span><br><span class="line">        <span class="keyword">if</span> (timeOut != <span class="keyword">null</span>) &#123;</span><br><span class="line">            redisTemplate.expire(key, timeOut, TimeUnit.SECONDS);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getObject</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue().get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-Controller"><a href="#3-Controller" class="headerlink" title="3.Controller"></a>3.Controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 余一</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/11/7  10:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtils redisUtils;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/setUser"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">setRedisKey</span><span class="params">(UserEntity userEntity)</span></span>&#123;</span><br><span class="line">       <span class="comment">//        redisUtils.setString("userEntity", JSONObject.toJSONString(userEntity));</span></span><br><span class="line">        redisTemplateUtils.setObject(<span class="string">"userEntity"</span>, userEntity);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"添加成功"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/getUser"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserEntity <span class="title">setRedisKey</span><span class="params">(String key)</span></span>&#123;</span><br><span class="line">        <span class="comment">//        String uerEntityJson = redisUtils.getString(key);</span></span><br><span class="line"><span class="comment">//        UserEntity userEntity = JSONObject.parseObject(uerEntityJson, UserEntity.class);</span></span><br><span class="line">        <span class="keyword">return</span> (UserEntity) redisTemplateUtils.getObject(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-配置文件"><a href="#4-配置文件" class="headerlink" title="4.配置文件"></a>4.配置文件</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  redis:</span><br><span class="line">    host: localhost</span><br><span class="line">    port: <span class="number">6379</span></span><br></pre></td></tr></table></figure>

<h3 id="SpringBoot整合Redis的注解版本"><a href="#SpringBoot整合Redis的注解版本" class="headerlink" title="SpringBoot整合Redis的注解版本"></a>SpringBoot整合Redis的注解版本</h3><ol>
<li><p>启动类开启我们的@EnableCaching</p>
</li>
<li><p>Controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/findMemberAll"</span>)</span><br><span class="line">    <span class="meta">@Cacheable</span>(cacheNames = <span class="string">"member"</span>, key = <span class="string">"'findMemberAll'"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;MemberEntity&gt; <span class="title">findMemberAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.findMemberAll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h3 id="MySQL与Redis的数据同步的问题如何解决？"><a href="#MySQL与Redis的数据同步的问题如何解决？" class="headerlink" title="MySQL与Redis的数据同步的问题如何解决？"></a>MySQL与Redis的数据同步的问题如何解决？</h3><ol>
<li>直接清理Redis的缓存，重新查询数据库即可~~</li>
<li>直接采用mq订阅mysql binlog日志文件增量同步到Redis中，整个过程采用最终一致性方案.</li>
<li>使用alibaba的canal</li>
</ol>
<h2 id="Redis持久化与集群机制"><a href="#Redis持久化与集群机制" class="headerlink" title="Redis持久化与集群机制"></a>Redis持久化与集群机制</h2><p>Redis提供了两种持久化的机制，分别为RDB、AOF实现，<strong>RDB</strong>采用定时（全量）持久化机制，但是服务器因为某种原因宕机后可能数据会丢失，<strong>AOF</strong>是基于数据日志操作实现的持久化，所以AOF采用增量同步的方案。</p>
<p>Redis已经帮助我默认开启了rdb存储。</p>
<p>Redis因为某种原因的情况下宕机之后，数据是不会丢失的,原理就是持久化。</p>
<p>Ehcache</p>
<p>大部分的缓存框架都会基本功能淘汰策略、持久机制</p>
<p><strong>Redis的持久化的机制有两种：aof、rdb（默认）</strong></p>
<p><strong>全量同步与增量同步区别：</strong></p>
<ol>
<li>全量同步就是每天定时(避开高峰期)或者是采用一种周期的实现将数据拷贝另外一个地方。</li>
</ol>
<p>频率不是很大，但是可能会造成数据的丢失。</p>
<ol start="2">
<li>增量同步采用行为操作对数据的实现同步</li>
</ol>
<p>频率非常高、对服务器同步的压力也是非常大的、保证数据不丢失。</p>
<h3 id="RDB同步"><a href="#RDB同步" class="headerlink" title="RDB同步"></a>RDB同步</h3><p><strong>Redis默认采用rdb方式实现数据的持久化，以快照的形式将数据持久化到磁盘的是一个二进制的文件dump.rdb</strong>。</p>
<p><img src="/2021/11/06/Redis/E:%5Cblog%5Csource_posts%5CRedis%5C1.png" alt></p>
<p>Redis会将数据集的快照dump到dump.rdb文件中。</p>
<p>此外，我们也可以通过配置文件来修改Redis服务器dump快照的频率，在打开redis.conf文件之后，我们搜索save，可以看到下面的配置信息：</p>
<p>save 900 1  #在900秒(15分钟)之后，如果至少有1个key发生变化，则dump内存快照。</p>
<p>save 300 10  #在300秒(5分钟)之后，如果至少有10个key发生变化，则dump内存快照。</p>
<p>save 60 10000 #在60秒(1分钟)之后，如果至少有10000个key发生变化，则dump内存快照。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Set(包含增加和覆盖)、del</span><br><span class="line">Set name yushengjun</span><br><span class="line">Set name mayikt</span><br><span class="line">Del name</span><br></pre></td></tr></table></figure>

<p><img src="/2021/11/06/Redis/E:%5Cblog%5Csource_posts%5CRedis%5C2.png" alt></p>
<h3 id="Aof同步"><a href="#Aof同步" class="headerlink" title="Aof同步"></a>Aof同步</h3><p>Aof是以执行命令的形式实现同步</p>
<p>在Redis的配置文件中存在三种同步方式，它们分别是：</p>
<p><strong>appendfsync always</strong>   每次有数据修改发生时都会写入到AOF文件，能够保证数据不丢失，但是效率非常低。</p>
<p><img src="/2021/11/06/Redis/E:%5Cblog%5Csource_posts%5CRedis%5C3.png" alt></p>
<p><strong>appendfsync everysec</strong> 每秒钟同步一次，可能会丢失1s内的数据，但是效率非常高。</p>
<p><img src="/2021/11/06/Redis/E:%5Cblog%5Csource_posts%5CRedis%5C4.png" alt></p>
<p><strong>appendfsync no</strong>  从不同步。高效但是数据不会被持久化。</p>
<p>直接修改redis.conf中 appendonly yes</p>
<p>建议最好还是使用everysec 既能够保证数据的同步、效率也还可以。</p>
<h3 id="RDB和AOF各自的优缺点"><a href="#RDB和AOF各自的优缺点" class="headerlink" title="RDB和AOF各自的优缺点"></a>RDB和AOF各自的优缺点</h3><ol>
<li><p>RDB属于全量同步（定时同步）</p>
<ul>
<li>优点：同步效率非常高</li>
<li>缺点：数据可能会丢失</li>
</ul>
</li>
<li><p>AOF属于增量同步，优点偏向实时（每隔1秒同步一次）</p>
<ul>
<li>优点：最多只会丢失1s的数据</li>
<li>缺点：同步效率比较低</li>
</ul>
</li>
</ol>
<p>如果AOF与RDB都开启，会优先使用AOF。</p>
<h2 id="Redis六大淘汰策略-amp-事务原理-amp-过期key事件监听"><a href="#Redis六大淘汰策略-amp-事务原理-amp-过期key事件监听" class="headerlink" title="Redis六大淘汰策略&amp;事务原理&amp;过期key事件监听"></a>Redis六大淘汰策略&amp;事务原理&amp;过期key事件监听</h2><p>将Redis用作缓存时，如果内存空间用满，就会自动驱逐老的数据。</p>
<h3 id="Redis六种淘汰策略"><a href="#Redis六种淘汰策略" class="headerlink" title="Redis六种淘汰策略"></a>Redis六种淘汰策略</h3><p><strong>noeviction：</strong>当内存使用达到阈值的时候，所有引起申请内存的命令会报错（默认）。</p>
<p><strong>allkeys-lru：</strong>在所有的key中，优先移除最近未使用的key。（推荐）</p>
<p><strong>volatile-lru：</strong>在设置了过期时间的键的空间中，优先移除最近未使用的key。</p>
<p><strong>allkeys-random：</strong>在所有的key中，随机移除某个key。</p>
<p><strong>volatile-random：</strong>在设置了过期时间的键空间中，随机移除某个key。</p>
<p><strong>volatile-ttl：</strong>在设置了过期时间的键空间中，具有更早过期时间的key优先移除。</p>
<h3 id="如何配置Resdis淘汰策略"><a href="#如何配置Resdis淘汰策略" class="headerlink" title="如何配置Resdis淘汰策略"></a>如何配置Resdis淘汰策略</h3><ol>
<li><p>在redis.conf文件中，*<em>maxmemory &lt; bytes &gt; *</em> 设置Redis内存大小的限制，当数据达到限定大小后，会选择配置的策略淘汰数据。</p>
<p>比如：maxmemory 300mb。</p>
</li>
<li><p>通过配置<strong>maxmemory-policy  noeviction</strong>设置Redis的淘汰策略。</p>
<p>比如：maxmemory-policy volatile-lru</p>
</li>
</ol>
<h3 id="Redis-key自动过期机制的使用"><a href="#Redis-key自动过期机制的使用" class="headerlink" title="Redis key自动过期机制的使用"></a>Redis key自动过期机制的使用</h3><p>当我们的key失效时，可以执行我们的客户端回调监听的方法。</p>
<p>需要在Redis中配置：<strong>notify-keyspace-events “Ex”</strong></p>
<h4 id="SpringBoot整合key失效监听"><a href="#SpringBoot整合key失效监听" class="headerlink" title="SpringBoot整合key失效监听"></a>SpringBoot整合key失效监听</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisListenerConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function">RedisMessageListenerContainer <span class="title">container</span><span class="params">(RedisConnectionFactory connectionFactory)</span> </span>&#123;</span><br><span class="line">        RedisMessageListenerContainer container = <span class="keyword">new</span> RedisMessageListenerContainer();</span><br><span class="line">        container.setConnectionFactory(connectionFactory);</span><br><span class="line">        <span class="keyword">return</span> container;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisKeyExpirationListener</span> <span class="keyword">extends</span> <span class="title">KeyExpirationEventMessageListener</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RedisKeyExpirationListener</span><span class="params">(RedisMessageListenerContainer listenerContainer)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(listenerContainer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 待支付</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer ORDER_STAYPAY = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 失效</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer ORDER_INVALID = <span class="number">2</span>;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Redis失效事件 key</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pattern</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onMessage</span><span class="params">(Message message, <span class="keyword">byte</span>[] pattern)</span> </span>&#123;</span><br><span class="line">        String expiraKey = message.toString();</span><br><span class="line">        <span class="comment">// 根据key查询 value 如果还还是为待支付状态 将订单改为已经超时~~</span></span><br><span class="line">        OrderEntity orderNumber = orderMapper.getOrderNumber(expiraKey);</span><br><span class="line">        System.out.println(expiraKey);</span><br><span class="line">        <span class="keyword">if</span> (orderNumber == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (orderNumber.getOrderStatus().equals(ORDER_STAYPAY)) &#123;</span><br><span class="line">            <span class="comment">// 将订单状态改为已经失效</span></span><br><span class="line">            orderMapper.updateOrderStatus(expiraKey, ORDER_INVALID);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtils redisUtils;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/saveOrder"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">saveOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1.生成token</span></span><br><span class="line">        String orderToken = UUID.randomUUID().toString();</span><br><span class="line">        String orderId = System.currentTimeMillis() + <span class="string">""</span>;</span><br><span class="line">        <span class="comment">//2. 将该token存放到redis中</span></span><br><span class="line">        redisUtils.setString(orderToken, orderId, <span class="number">5L</span>);</span><br><span class="line">        OrderEntity orderEntity = <span class="keyword">new</span> OrderEntity(<span class="keyword">null</span>, <span class="string">"永久会员"</span>, orderId, orderToken);</span><br><span class="line">        <span class="keyword">int</span> result = orderMapper.insertOrder(orderEntity);</span><br><span class="line">        <span class="keyword">return</span> result &gt; <span class="number">0</span> ? <span class="string">"success"</span> : <span class="string">"fail"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String orderName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 0 待支付 1 已经支付</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer orderStatus;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String orderToken;</span><br><span class="line">    <span class="keyword">private</span> String orderId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrderEntity</span><span class="params">(Long id, String orderName, String orderId, String orderToken)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.orderName = orderName;</span><br><span class="line">        <span class="keyword">this</span>.orderId = orderId;</span><br><span class="line">        <span class="keyword">this</span>.orderToken = orderToken;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">"insert into order_number values (null,#&#123;orderName&#125;,0,#&#123;orderToken&#125;,#&#123;orderId&#125;)"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insertOrder</span><span class="params">(OrderEntity OrderEntity)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"SELECT ID AS ID ,order_name AS ORDERNAME ,order_status AS orderstatus,order_token as ordertoken,order_id as  orderid FROM order_number\n"</span> +</span><br><span class="line">            <span class="string">"where order_token=#&#123;orderToken&#125;;"</span>)</span><br><span class="line">    <span class="function">OrderEntity <span class="title">getOrderNumber</span><span class="params">(String orderToken)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update</span>(<span class="string">"\n"</span> +</span><br><span class="line">            <span class="string">"\n"</span> +</span><br><span class="line">            <span class="string">"update order_number set order_status=#&#123;orderStatus&#125; where order_token=#&#123;orderToken&#125;;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateOrderStatus</span><span class="params">(String orderToken, Integer orderStatus)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Redis事务操作"><a href="#Redis事务操作" class="headerlink" title="Redis事务操作"></a>Redis事务操作</h3><p><strong>Multi</strong>  命令开启事务</p>
<p><strong>EXEC</strong> 提交事务</p>
<p>Watch  可以监听一个或多个key,在提交事务之前是否有发生了变化 如果发生了变化就不会提交事务，没有发生变化才可以提交事务 版本号码 乐观锁</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span> <span class="string">name</span></span><br><span class="line"><span class="attr">multi</span></span><br><span class="line"><span class="attr">set</span> <span class="string">name owen</span></span><br><span class="line"><span class="attr">exec</span></span><br></pre></td></tr></table></figure>

<p><strong>Discard</strong>  取消提交事务</p>
<p><strong>注意：Redis</strong>官方是没有提供回滚方法， 只提供了取消事务。</p>
<h2 id="Redis实现分布式锁"><a href="#Redis实现分布式锁" class="headerlink" title="Redis实现分布式锁"></a>Redis实现分布式锁</h2><h3 id="乐观锁和悲观锁"><a href="#乐观锁和悲观锁" class="headerlink" title="乐观锁和悲观锁"></a>乐观锁和悲观锁</h3><p><strong>悲观锁(Pessimistic Lock)：</strong>顾名思义，就是很悲观，每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据会block直到它拿到锁。传统的关系型数据库里面就用到了很多这种锁机制，比如行锁，表锁等，读锁，写锁等，都是在操作之前先上锁。</p>
<p><strong>乐观锁(Optimistic Lock)：</strong>顾名思义，就很乐观，每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号等机制。乐观锁适用于多读的应用类型，这样可以提高吞吐量。</p>
<p>乐观锁策略：提交版本必须大于记录当前版本才能执行更新。</p>
<h3 id="什么是分布式锁"><a href="#什么是分布式锁" class="headerlink" title="什么是分布式锁"></a>什么是分布式锁</h3><p><strong>本地锁：</strong>在多个线程中保证只有一个线程执行（线程安全问题）</p>
<p><strong>分布锁：</strong>在分布式中，保证只有一个Jvm执行（多个jvm线程安全问题）</p>
<p>如果我们服务器是集群的时候，定时任务可能会重复执行  可以采用分布式锁解决</p>
<p><strong>解决分布式锁核心思路</strong></p>
<ol>
<li><p>获取锁</p>
<p>多个不同的jvm同时创建一个相同的标记（全局唯一的）只要谁能够创建成功谁就能获取锁。</p>
</li>
<li><p>释放锁</p>
<p> 释放该全局唯一的标记，其他的jvm重新进入到获取锁资源。</p>
</li>
<li><p>超时锁（没有获取锁、已经获取锁）</p>
<p>等待获取锁的超时时间</p>
<p>已经获取到锁 锁的有效期5s</p>
</li>
</ol>
<p><strong>分析：基于Redis实现分布式锁思路</strong></p>
<p>1.获取锁</p>
<p>多个不同的jvm 同时创建一个相同的标记使用Setnx命令，因为Rediskey必须保证是唯一的，只要谁能够创建成功谁就能够获取锁</p>
<p>Set命令的时候：如果key不存在则创建，如果key已经存在则修改原值；</p>
<p>SetNx命令: 如果key不存在则创建 返回1,如果已经存在则不执行任何操作返回0</p>
<p>1 不存在创建成功 0 已经存在 不执行任何操作。</p>
<p>2.释放锁</p>
<p>对我们的redis的key设置一个有效期（或者是主动删除该key）可以灵活的自动的释放该全局唯一的标记，其他的jvm重新进入到获取锁资源。</p>
<p>3.超时锁（没有获取锁、已经获取锁）</p>
<p>等待获取锁的超时时间</p>
<p>已经获取到锁 锁的有效期 5s</p>
<p><strong>分析基于Zk实现分布式锁思路</strong></p>
<ol>
<li>获取锁</li>
</ol>
<p>多个不同的jvm在zk集群上创建一个相同的全局唯一的临时路径，只要谁能够创建成功谁就能够获取到锁。</p>
<p> 分析：临时节点对我们节点设置有效期</p>
<ol start="2">
<li><p>释放锁</p>
<p>人为主动删除该节点或者使用Session有效期</p>
</li>
<li><p>超时锁（没有获取锁、已经获取锁）</p>
</li>
</ol>
<p>等待获取锁的超时时间</p>
<p>已经获取到锁 锁的有效期 5s </p>
<p>Redis也类似于zk事件通知</p>
<p>Redis官网是有了一个redis解决分布锁框架redission</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/11/02/Java%E5%8F%8D%E5%B0%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/02/Java%E5%8F%8D%E5%B0%84/" class="post-title-link" itemprop="url">Java反射</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-02 16:41:54" itemprop="dateCreated datePublished" datetime="2021-11-02T16:41:54+08:00">2021-11-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-06 00:13:52" itemprop="dateModified" datetime="2021-11-06T00:13:52+08:00">2021-11-06</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>使用反射机制，可以通过外部配置文件，在不修改源码的情况下修改程序。</p>
<p><img src="/2021/11/02/Java%E5%8F%8D%E5%B0%84/1.png" alt></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用Properties类读取配置文件</span></span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        properties.load(<span class="keyword">new</span> FileInputStream(<span class="string">"E:\\javaHome\\reflex\\src\\properties.properties"</span>));</span><br><span class="line">        String classFullPath = properties.get(<span class="string">"classfullpath"</span>).toString();</span><br><span class="line">        String method = properties.get(<span class="string">"method"</span>).toString();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//根据类名称得到该类的类对象</span></span><br><span class="line">        Class&lt;?&gt; catClass = Class.forName(classFullPath);</span><br><span class="line">        <span class="comment">//调用该类对象的newInstance方法，返回一个当前类（Cat）的实例</span></span><br><span class="line">        Object cat = catClass.newInstance();</span><br><span class="line">        <span class="comment">//参数method是从配置文件读取到的方法名称</span></span><br><span class="line">        Method method1 = catClass.getMethod(method);</span><br><span class="line">        <span class="comment">//通过该类（Cat）的方法类调用invoke，实现调用实例的方法</span></span><br><span class="line">        method1.invoke(cat);</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/11/02/Java%E5%8F%8D%E5%B0%84/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/10/24/%E7%BB%99%E5%9B%9E%E9%81%BF%E5%9E%8B%E4%BA%BA%E6%A0%BC%E7%9A%845%E4%B8%AA%E5%BB%BA%E8%AE%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/24/%E7%BB%99%E5%9B%9E%E9%81%BF%E5%9E%8B%E4%BA%BA%E6%A0%BC%E7%9A%845%E4%B8%AA%E5%BB%BA%E8%AE%AE/" class="post-title-link" itemprop="url">给回避型人格的5个建议</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-24 23:48:58" itemprop="dateCreated datePublished" datetime="2021-10-24T23:48:58+08:00">2021-10-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-31 11:56:25" itemprop="dateModified" datetime="2021-10-31T11:56:25+08:00">2021-10-31</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>519</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-对自己要有理解和接纳"><a href="#1-对自己要有理解和接纳" class="headerlink" title="1.对自己要有理解和接纳"></a>1.对自己要有理解和接纳</h2><p>就心理学有这么一个说法，就是，在你的童年，你形成这样的人格，形成这样的风格，通常就是你能做的最好的选择，所以，如果真的发现自己是回避性人格，如果对自己有一份宽容，有一份接纳，这是一个很重要的部分。</p>
<h2 id="2-直面这个真相"><a href="#2-直面这个真相" class="headerlink" title="2.直面这个真相"></a>2.直面这个真相</h2><p>假如，当我们去直面自己的很多问题的时候，我们可能非常痛苦和难受，但是这个痛苦和难受，也是会推动我们去做一些改变。</p>
<h2 id="3-要知道你的感受未必是真实的"><a href="#3-要知道你的感受未必是真实的" class="headerlink" title="3.要知道你的感受未必是真实的"></a>3.要知道你的感受未必是真实的</h2><p>就是对于经典的回避型人格来讲，你必须明白一个东西，<strong>你是严重地贬低了自己</strong>。</p>
<p>你的感受特别的重要，但并不意味着，你的感受就是真实的，你对外部世界的敌意，你做了严重地放大，十倍的放大，百倍的放大，当你认定对方是这样的时候，你要松动这个东西，不要死死地抱着这个东西，你就是这么有敌意的，你就是严重的伤害了我，如果你总是认定这个部分，这是非常非常危险的。</p>
<h2 id="4-你可以试着对外部世界提一些要求"><a href="#4-你可以试着对外部世界提一些要求" class="headerlink" title="4.你可以试着对外部世界提一些要求"></a>4.你可以试着对外部世界提一些要求</h2><p>你可以试着去控制一些，你可以控制的人，或者可以控制的这个事物，就比方，你在谈恋爱的时候，那么女孩在给自己的男朋友提一些特别过分的要求的时候，就是她希望对方百分百地按照自己的意愿那样去做。<strong>要对自己的这种霸道，要有觉知，那就是，不要觉得这就是百分百的就应该这个样子。</strong></p>
<h2 id="5-寻找专业人士的帮助"><a href="#5-寻找专业人士的帮助" class="headerlink" title="5.寻找专业人士的帮助"></a>5.寻找专业人士的帮助</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/10/19/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/19/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" class="post-title-link" itemprop="url">网络编程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-19 22:16:03" itemprop="dateCreated datePublished" datetime="2021-10-19T22:16:03+08:00">2021-10-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-02 16:49:14" itemprop="dateModified" datetime="2021-11-02T16:49:14+08:00">2021-11-02</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>网络通信</strong></p>
<ol>
<li>两台设备之间通过网络实现数据传输</li>
<li>将数据通过网络从一台设备传输到另一台设备</li>
<li>java.net包下提供了一系列的类或接口，供程序员使用，完成网络通信</li>
</ol>
<p><strong>网络</strong></p>
<ol>
<li>两台或多台设备通过一定物理设备连接起来构成了网络</li>
<li>根据网络覆盖范围不同，对网络进行分类：<ul>
<li>局域网：覆盖范围最小，仅仅覆盖一个教室或一个机房</li>
<li>城域网：覆盖范围较大，可以覆盖一个城市</li>
<li>广域网：覆盖范围最大，可以覆盖全国，甚至全球，万维网是广域网的代表。</li>
</ul>
</li>
</ol>
<h2 id="TCP和UDP"><a href="#TCP和UDP" class="headerlink" title="TCP和UDP"></a>TCP和UDP</h2><p><img src="/2021/10/19/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/1.png" alt></p>
<h2 id="InetAddress类"><a href="#InetAddress类" class="headerlink" title="InetAddress类"></a>InetAddress类</h2><p>相关方法：</p>
<ol>
<li><strong>getLocalHost:</strong>获取本机InetAddress对象</li>
<li><strong>getByName:</strong>根据指定主机名/域名获取ip地址对象</li>
<li><strong>getHostName:</strong>获取InetAddress对象的主机名</li>
<li><strong>getHostAddress:</strong>获取InetAddress对象的地址</li>
</ol>
<h2 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h2><ol>
<li>Socket开发网络应用程序被广泛采用，以至于成为事实上的标准</li>
<li>通信的两端都要有Socket,是两台机器间通信的端点</li>
<li><strong>网络通信其实就是Socket之间的通信</strong></li>
<li>Socket允许程序把网络连接当成一个流，数据在两个Socket间通过IO传输</li>
<li>一般主动发起通信的应用程序属客户端，等待通信请求的为服务端</li>
</ol>
<h2 id="TCP编程"><a href="#TCP编程" class="headerlink" title="TCP编程"></a>TCP编程</h2><h3 id="案例1：使用字节流"><a href="#案例1：使用字节流" class="headerlink" title="案例1：使用字节流"></a>案例1：使用字节流</h3><ol>
<li><p>编写一个服务器端，和一个客户端</p>
</li>
<li><p>服务器端在9999端口监听</p>
</li>
<li><p>客户端连接到服务器端，发送”Hello,Server”,然后退出</p>
</li>
<li><p>服务器端接收到客户端发送的信息，输出，并退出</p>
<p><strong>服务端：</strong></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.在本机的9999端口监听，等待连接</span></span><br><span class="line"><span class="comment">//细节：要求在本机没有其他服务在监听9999</span></span><br><span class="line">ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line"><span class="comment">//2.当没有客户端连接9999端口时，程序会阻塞，等待连接</span></span><br><span class="line"><span class="comment">//如果有客户端连接，则会返回Socket对象，程序继续</span></span><br><span class="line"><span class="comment">//细节：这个serverSocket可以通过accept()返回多个Socket[多个客户端连接服务器的并发]</span></span><br><span class="line">Socket socket = serverSocket.accept();</span><br><span class="line">System.out.println(<span class="string">"服务端 socket ="</span> + socket.getClass());</span><br><span class="line"><span class="comment">//3.通过socket.getInputStream()读取客户端写入到数据通道的数据，显示</span></span><br><span class="line">InputStream inputStream = socket.getInputStream();</span><br><span class="line"><span class="comment">//4.io读取</span></span><br><span class="line"><span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line"><span class="keyword">int</span> len;</span><br><span class="line"><span class="keyword">while</span> ((len = inputStream.read(buff)) != -<span class="number">1</span>)&#123;</span><br><span class="line">    System.out.print(<span class="keyword">new</span> String(buff,<span class="number">0</span>,len));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//5.关闭流</span></span><br><span class="line">serverSocket.close();</span><br><span class="line">socket.close();</span><br><span class="line">inputStream.close();</span><br></pre></td></tr></table></figure>

<p><strong>客户端:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/<span class="number">1</span>.连接服务端(ip,端口)</span><br><span class="line"><span class="comment">//解读：连接本机的9999端口</span></span><br><span class="line">Socket socket = <span class="keyword">new</span> Socket(InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line"><span class="comment">//2.连接上后，生成socket</span></span><br><span class="line">OutputStream socketOutputStream = socket.getOutputStream();</span><br><span class="line"><span class="comment">//3.通过输出流，写入数据到，数据通道</span></span><br><span class="line">socketOutputStream.write(<span class="string">"hello,server !"</span>.getBytes());</span><br><span class="line"> <span class="comment">//设置结束标记</span></span><br><span class="line"> socket.shutdownOutput();</span><br><span class="line"><span class="comment">//4.关闭流对象，和socket,退出</span></span><br><span class="line">socketOutputStream.close();</span><br><span class="line">socket.close();</span><br><span class="line">System.out.println(<span class="string">"客户端退出..."</span>);</span><br></pre></td></tr></table></figure>

<h3 id="案例2：使用字符流"><a href="#案例2：使用字符流" class="headerlink" title="案例2：使用字符流"></a>案例2：使用字符流</h3><ol>
<li>编写一个服务器端，和一个客户端</li>
<li>服务器端在9999端口监听</li>
<li>客户端连接到服务器端，发送”Hello,Server”,并接收服务端回发的”hello,client”,然后退出</li>
<li>服务器端接收到客户端发送的信息，输出，并发送”hello,client”,退出</li>
</ol>
<p><strong>客户端：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Socket socket = <span class="keyword">new</span> Socket(InetAddress.getLocalHost(), <span class="number">9999</span>);</span><br><span class="line">OutputStream socketOutputStream = socket.getOutputStream();</span><br><span class="line">BufferedWriter bufferedWriter = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(socketOutputStream));</span><br><span class="line"><span class="comment">//3.通过字符流，写入数据到，数据通道</span></span><br><span class="line">bufferedWriter.write(<span class="string">"hello,server"</span>);</span><br><span class="line">bufferedWriter.newLine();</span><br><span class="line">bufferedWriter.flush();</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.获取socket关联的输入流，读取字符</span></span><br><span class="line">InputStream inputStream = socket.getInputStream();</span><br><span class="line">BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(inputStream));</span><br><span class="line">String readData = bufferedReader.readLine();</span><br><span class="line">System.out.println(readData);</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.关闭流对象，和socket,退出</span></span><br><span class="line">bufferedReader.close();</span><br><span class="line">bufferedWriter.close();</span><br><span class="line">socket.close();</span><br><span class="line">System.out.println(<span class="string">"客户端退出..."</span>);</span><br></pre></td></tr></table></figure>

<p><strong>服务端：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">9999</span>);</span><br><span class="line">Socket socket = serverSocket.accept();</span><br><span class="line">System.out.println(<span class="string">"服务端 socket ="</span> + socket.getClass());</span><br><span class="line"></span><br><span class="line">InputStream inputStream = socket.getInputStream();</span><br><span class="line">BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(inputStream));</span><br><span class="line">String readData = bufferedReader.readLine();</span><br><span class="line">System.out.println(readData);</span><br><span class="line"></span><br><span class="line">OutputStream outputStream = socket.getOutputStream();</span><br><span class="line">BufferedWriter bufferedWriter = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(outputStream));</span><br><span class="line">bufferedWriter.write(<span class="string">"hello,客户端，我是服务端，我接收到你的信息了！"</span>);</span><br><span class="line">bufferedWriter.newLine();<span class="comment">//插入一个换行符，表示写入的内容结束,注意，要求对方使用readLine()</span></span><br><span class="line">bufferedWriter.flush();<span class="comment">//如果使用字符流，需要手动刷新，否则数据不会写入数据通道</span></span><br><span class="line">serverSocket.close();</span><br><span class="line">socket.close();</span><br><span class="line">bufferedWriter.close();</span><br><span class="line">bufferedReader.close();</span><br></pre></td></tr></table></figure>

<h2 id="netstat-指令"><a href="#netstat-指令" class="headerlink" title="netstat 指令"></a>netstat 指令</h2><ol>
<li>netstat -an 可以查看当前主机网络情况，包括<strong>端口监听情况</strong>和<strong>网络连接情况</strong></li>
<li>netstat -an | more 可以分页显示</li>
<li>netstat -anb 可以看到具体是哪个程序在监听该端口</li>
<li>要求在dos控制台上执行</li>
</ol>
<p><img src="/2021/10/19/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/2.png" alt></p>
<h2 id="Tcp连接秘密"><a href="#Tcp连接秘密" class="headerlink" title="Tcp连接秘密"></a>Tcp连接秘密</h2><ol>
<li>当客户端连接到服务端后，实际上客户端也是通过一个端口和服务端进行通讯的，这个端口是TCP/IP来分配的，是不确定(随机)的；</li>
</ol>
<h2 id="UDP编程"><a href="#UDP编程" class="headerlink" title="UDP编程"></a>UDP编程</h2><p><img src="/2021/10/19/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/3.png" alt></p>
<h2 id="多用户通信系统"><a href="#多用户通信系统" class="headerlink" title="多用户通信系统"></a>多用户通信系统</h2><p><img src="/2021/10/19/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/4.png" alt></p>
<p><img src="/2021/10/19/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/6.png" alt></p>
<p><img src="/2021/10/19/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/5.png" alt></p>
<p>客户端代码：</p>
<p><a href="https://gitee.com/hluck/client.git" target="_blank" rel="noopener">网络通信案例-客户端源码</a></p>
<p>服务端代码：</p>
<p><a href="https://gitee.com/hluck/server.git" target="_blank" rel="noopener">网络通信案例-服务端源码</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/10/13/IO%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/13/IO%E6%B5%81/" class="post-title-link" itemprop="url">IO流</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-13 22:26:12" itemprop="dateCreated datePublished" datetime="2021-10-13T22:26:12+08:00">2021-10-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-02-15 12:05:50" itemprop="dateModified" datetime="2022-02-15T12:05:50+08:00">2022-02-15</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h2><p>文件在程序中是以流的形式来操作的。</p>
<p><strong>流：</strong>数据在数据源（文件）和程序（内存）之间经历的路径。</p>
<p><strong>输入流：</strong>数据从数据源（文件）到程序（内存）的路径；</p>
<p><strong>输出流：</strong>数据从程序（内存）到数据源（文件）的路径；</p>
<h3 id="常用的文件操作"><a href="#常用的文件操作" class="headerlink" title="常用的文件操作"></a>常用的文件操作</h3><h4 id="1-创建文件对象相关构造器和方法"><a href="#1-创建文件对象相关构造器和方法" class="headerlink" title="1.创建文件对象相关构造器和方法"></a>1.创建文件对象相关构造器和方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(String pathname)<span class="comment">//根据路径构建一个File对象</span></span><br><span class="line"><span class="keyword">new</span> File(File parent,String child)<span class="comment">//根据父目录文件+子路径构建</span></span><br><span class="line"><span class="keyword">new</span> File(String pathname)<span class="comment">//根据父目录+子路径构建</span></span><br></pre></td></tr></table></figure>

<h2 id="文件字节流"><a href="#文件字节流" class="headerlink" title="文件字节流"></a>文件字节流</h2><p>InputStream抽象类是所有类字节输入流的超类</p>
<p>InputStream 常用的子类</p>
<ol>
<li>FileInputStream: 文件输入流</li>
<li>BufferedInputStream:缓冲字节输入流</li>
<li>ObjectInputStream: 对象字节输入流</li>
</ol>
<h4 id="1-FileInputStream-字节输入流"><a href="#1-FileInputStream-字节输入流" class="headerlink" title="1.FileInputStream:字节输入流"></a>1.FileInputStream:字节输入流</h4>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/10/13/IO%E6%B5%81/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/10/10/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/10/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">多线程基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-10 17:33:14" itemprop="dateCreated datePublished" datetime="2021-10-10T17:33:14+08:00">2021-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-31 11:55:03" itemprop="dateModified" datetime="2021-10-31T11:55:03+08:00">2021-10-31</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>807</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="线程和进程"><a href="#线程和进程" class="headerlink" title="线程和进程"></a>线程和进程</h2><p><strong>进程：</strong>进程是程序的一次执行过程，是系统运行程序的基本单位，因此是动态的。系统的一个程序即是一个进程从创建，运行到消亡的过程。</p>
<p>在 Java 中，当我们启动 main 函数时其实就是启动了⼀个 JVM 的进程，⽽ main 函数所在的线<br>程就是这个进程中的⼀个线程，也称主线程。</p>
<p><strong>线程：</strong>是⼀个⽐进程更⼩的执⾏单位，⼀个进程在其执⾏的过程中可以产⽣多<br>个线程。</p>
<h2 id="线程常用方法"><a href="#线程常用方法" class="headerlink" title="线程常用方法"></a>线程常用方法</h2><ol>
<li>setName //设置线程名称，使之与参数name相同</li>
<li>getName  //返回该线程名称。</li>
<li>start //使该线程开始执行；Java虚拟机底层调用该线程的start0方法</li>
<li>run  //调用该对象run方法</li>
<li>setPriority //更改线程的优先级</li>
<li>getPriority //获取线程的优先级</li>
<li>sleep  //在指定的毫秒数内让当前正在执行的线程休眠（暂停执行），不会释放锁。</li>
<li>interrupt  //中断线程，但并没有真正的结束线程。所以一般用于中断正在休眠线程。</li>
<li>yield:线程的礼让。让出cpu,让其他线程执行，但礼让的时间不确定，所以也不一定礼让成功。</li>
<li>join:线程的插队。插队的线程一旦插队成功，则肯定先执行完插入的线程所有任务。</li>
</ol>
<h2 id="用户线程和守护线程"><a href="#用户线程和守护线程" class="headerlink" title="用户线程和守护线程"></a>用户线程和守护线程</h2><p>1.用户线程：也叫工作线程，当线程的任务执行完毕，或通知方式结束。</p>
<p>2.守护线程：一般是为工作线程服务的，当所有用户线程结束，守护线程自动结束</p>
<p>3.常见的守护线程：垃圾回收机制</p>
<h2 id="线程的生命周期"><a href="#线程的生命周期" class="headerlink" title="线程的生命周期"></a>线程的生命周期</h2><ol>
<li>新建状态</li>
<li>就绪状态</li>
<li>运行状态</li>
<li>阻塞状态</li>
<li>死亡状态</li>
</ol>
<p><img src="/2021/10/10/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/1.png" alt></p>
<h2 id="线程同步"><a href="#线程同步" class="headerlink" title="线程同步"></a>线程同步</h2><p>即当有一个线程在对内存进行操作时，其他线程都不可以对这个内存地址进行操作，直到该线程完成操作，其他线程才能对该内存地址进行操作。</p>
<h3 id="同步方式"><a href="#同步方式" class="headerlink" title="同步方式"></a>同步方式</h3><ol>
<li><p>同步代码块</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(对象)&#123;<span class="comment">//得到对象的锁，才能操作同步代码</span></span><br><span class="line">		<span class="comment">//需要被同步代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>同步方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">m</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">    <span class="comment">//需要被同步的代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/10/04/java8%E6%96%B0%E7%89%B9%E6%80%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/04/java8%E6%96%B0%E7%89%B9%E6%80%A7/" class="post-title-link" itemprop="url">java8新特性</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-04 11:15:11" itemprop="dateCreated datePublished" datetime="2021-10-04T11:15:11+08:00">2021-10-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-10-07 14:01:58" itemprop="dateModified" datetime="2021-10-07T14:01:58+08:00">2021-10-07</time>
              </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>14k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>13 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-接口默认方法修饰为普通方法"><a href="#1-接口默认方法修饰为普通方法" class="headerlink" title="1.接口默认方法修饰为普通方法"></a>1.接口默认方法修饰为普通方法</h2><p>在jdk8之前，interface之中可以定义变量和方法，变量必须是public、static、final的，方法必须是public、abstract的，这些修饰符都是默认的。</p>
<ul>
<li>接口定义的方法：public 抽象方法 需要子类实现</li>
<li>接口定义变量：public  static  final</li>
</ul>
<p><strong>jdk1.8开始，支持使用static 和 default 修饰 可以写方法体，不需要子类重写。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.education;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 余一</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/10/4  11:29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">JDK18Example</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">default</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"hello! jdk 1.8"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">staticSay</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"hello! java8"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sayHi</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JdkTest</span> <span class="keyword">implements</span> <span class="title">JDK18Example</span></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 默认方法和静态方法不是抽象的，不需要重写</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHi</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"hi"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/10/04/java8%E6%96%B0%E7%89%B9%E6%80%A7/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/09/24/shiro/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/24/shiro/" class="post-title-link" itemprop="url">shiro</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-09-24 09:37:56 / 修改时间：09:39:18" itemprop="dateCreated datePublished" datetime="2021-09-24T09:37:56+08:00">2021-09-24</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Shiro是一个强大且易用的Java安全框架，它提供了身份验证、授权、密码和会话管理的功能。</p>
<h2 id="1-Shiro-三大核心组件"><a href="#1-Shiro-三大核心组件" class="headerlink" title="1.Shiro 三大核心组件"></a>1.Shiro 三大核心组件</h2><p><strong>1.Subject(主体)： 代表当前用户的安全操作，该接口提供登录和登出的方法</strong></p>
<p><strong>2.SecurityManager： 用来管理所有用户的安全操作，需要从realms中获取用户信息来确定用户的身份是否合法</strong></p>
<p><strong>3.Realms：身份认证器</strong>，自定义一个Realms实现认证和授权。</p>
<h2 id="2-Shiro中的重要组件"><a href="#2-Shiro中的重要组件" class="headerlink" title="2.Shiro中的重要组件"></a>2.Shiro中的重要组件</h2><p><strong>Authenticator</strong>     身份认证、登录，验证用户是否拥有响应的身份。</p>
<p><strong>Authrizer</strong>             授权，即权限验证，验证某个已认证的用户是否拥有某个权限。</p>
<p><strong>SessionManager</strong>        会话管理，即用户登录后就是一次会话，在没有退出之前，它的所有信息都在会话中。</p>
<p><strong>CacheManager</strong>         缓存控制器，来管理如用户、角色、权限等的缓存的；</p>
<p><strong>SessionDAO</strong>         DAO大家都用过，数据访问对象，用于会话的CRUD;</p>
<h2 id="3-Shiro过滤器"><a href="#3-Shiro过滤器" class="headerlink" title="3.Shiro过滤器"></a>3.Shiro过滤器</h2><table>
<thead>
<tr>
<th>过滤器名称</th>
<th align="left">类名</th>
<th align="right">含义</th>
</tr>
</thead>
<tbody><tr>
<td><strong>anon</strong></td>
<td align="left">org.apache.shiro.web.filter.authc.AnonymousFilter</td>
<td align="right"><strong>表示接口不需要登录即可访问</strong></td>
</tr>
<tr>
<td><strong>authc</strong></td>
<td align="left">org.apache.shiro.web.filter.authc.FormAuthenticationFilter</td>
<td align="right"><strong>表示需要身份认证通过后才能访问</strong></td>
</tr>
<tr>
<td><strong>roles</strong></td>
<td align="left">org.apache.shiro.web.filter.authz.RolesAuthorizationFilter</td>
<td align="right"><strong>拥有某个角色权限才能访问</strong></td>
</tr>
<tr>
<td><strong>user</strong></td>
<td align="left">org.apache.shiro.web.filter.authz.UserFilter</td>
<td align="right"><strong>表示需要身份认证通过后才能访问</strong></td>
</tr>
<tr>
<td><strong>perms</strong></td>
<td align="left">org.apache.shiro.web.filter.authz.PermissionsAuthorizationFilter</td>
<td align="right"><strong>表示需要指定权限才能访问</strong></td>
</tr>
</tbody></table>
<p><strong>其中，authc表示已经认证过，user表示已经登录过</strong></p>
<h2 id="4-URL匹配模式"><a href="#4-URL匹配模式" class="headerlink" title="4.URL匹配模式"></a>4.URL匹配模式</h2><p>？：匹配一个字符，如/admin？将匹配/admin1,但不匹配/admin  或 /admin/;</p>
<p>*：匹配多个或零个字符串，如/admin *   将匹配/admin、/admin123，但不匹配/admin/1;</p>
<p>/** ：匹配路径中的零个或多个路径，如/admin/ **将匹配/admin/a或/admin/a/b</p>
<h3 id="URL匹配顺序"><a href="#URL匹配顺序" class="headerlink" title="URL匹配顺序"></a>URL匹配顺序</h3><p>URL权限采取第一次匹配优先的方式，即从头开始使用第一个匹配的url模式对应的拦截器链。</p>
<p>如：</p>
<p>​    - /admin/ * *=anon</p>
<p>​    - / * * =authc</p>
<p>​    如果请求的url是”/admin/getRoleList”，因为按照声明顺序进行匹配，那么将使用anon进行拦截。</p>
<h2 id="5-Shiro中的接口权限注解"><a href="#5-Shiro中的接口权限注解" class="headerlink" title="5.Shiro中的接口权限注解"></a>5.Shiro中的接口权限注解</h2><ol>
<li>@RequiresAuthentication: 表示Subject已经通过login进行了身份验证</li>
<li>@RequiresUser: 表示当前Subject 已经身份验证或者通过记住我登录的</li>
<li>@RequiresGuest: 表示当前Subject没有身份验证或通过记住我登录过，即是游客身份。</li>
<li>@RequiresRoles(value={“admin”,”user”},logical=Logical.AND):表示当前Subject需要角色admin和user</li>
<li>@RequiresPermissions(value={“user:a”,”user:b”},logical=Logical.OR): 表示当前Subject需要权限user:a 或user: b</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/09/24/SpringBoot%E6%95%B4%E5%90%88Quartz/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/24/SpringBoot%E6%95%B4%E5%90%88Quartz/" class="post-title-link" itemprop="url">SpringBoot整合Quartz</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-09-24 09:36:51 / 修改时间：09:36:27" itemprop="dateCreated datePublished" datetime="2021-09-24T09:36:51+08:00">2021-09-24</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-Quartz介绍"><a href="#1-Quartz介绍" class="headerlink" title="1.Quartz介绍"></a>1.Quartz介绍</h2><h3 id="1-QUartz是什么？"><a href="#1-QUartz是什么？" class="headerlink" title="1.QUartz是什么？"></a>1.QUartz是什么？</h3><p><strong>Quartz</strong>是一个功能丰富的开源任务调度框架，它可以创建简单或复杂的几十、几百、甚至成千上万的job(任务)。此外，quartz调度器还支持JTA事务和集群。</p>
<h3 id="2-Quartz和Spring-Task区别"><a href="#2-Quartz和Spring-Task区别" class="headerlink" title="2.Quartz和Spring Task区别"></a>2.Quartz和Spring Task区别</h3><ol>
<li>Quartz默认多线程异步执行，而Spring Task默认单线程同步执行。</li>
<li>Spring Task属于轻量级任务调度框架，使用更简单</li>
<li>Quartz在执行任务中如果抛出异常，不影响下一次任务的执行，当下一次任务时间到来时，定时器会再次执行任务。而使用Spring Task一旦某个任务执行中抛出异常，则整个定时器生命周期就结束，以后永远不会再执行定时器任务。</li>
<li>Quartz每次执行都创建一个新的任务类对象，Spring Task则每次使用同一个任务类对象。</li>
</ol>
<h3 id="3-Quartz三要素"><a href="#3-Quartz三要素" class="headerlink" title="3.Quartz三要素"></a>3.Quartz三要素</h3><h4 id="1-Scheduler"><a href="#1-Scheduler" class="headerlink" title="1.Scheduler"></a>1.Scheduler</h4><p>任务调度器，他是Quartz的核心所在，所有的任务都是通过scheduler开始的</p>
<h4 id="2-Trigger"><a href="#2-Trigger" class="headerlink" title="2.Trigger"></a>2.Trigger</h4><p>任务触发器</p>
<h4 id="3-JobDetail-和-Job"><a href="#3-JobDetail-和-Job" class="headerlink" title="3.JobDetail 和 Job"></a>3.JobDetail 和 Job</h4><p>定义任务具体的执行逻辑</p>
<h3 id="4-Trigger类中的常用方法"><a href="#4-Trigger类中的常用方法" class="headerlink" title="4.Trigger类中的常用方法"></a>4.Trigger类中的常用方法</h3><ol>
<li><strong>withIdentity(String name,String  gtoup)</strong> 给触发器一些属性，比如名字，组名。</li>
<li><strong>startNow()</strong> 立刻启动</li>
<li><strong>wiehSchedule(ScheduleBuilder scheduleBuilder)以某种触发器触发</strong></li>
<li><strong>usingJobData(String dataKey,Boolean value)</strong>给具体job传递参数</li>
</ol>
<h3 id="5-ScheduleBuilder-任务触发器-接口"><a href="#5-ScheduleBuilder-任务触发器-接口" class="headerlink" title="5.ScheduleBuilder(任务触发器)接口"></a>5.ScheduleBuilder(任务触发器)接口</h3><h4 id="1-CalendarIntervalScheduleBuilder-通过指定对应日期的定时执行触发器"><a href="#1-CalendarIntervalScheduleBuilder-通过指定对应日期的定时执行触发器" class="headerlink" title="1.CalendarIntervalScheduleBuilder:通过指定对应日期的定时执行触发器"></a>1.CalendarIntervalScheduleBuilder:通过指定对应日期的定时执行触发器</h4><h4 id="2-DailyTimeIntervalScheduleBuilder-根据时间定时执行"><a href="#2-DailyTimeIntervalScheduleBuilder-根据时间定时执行" class="headerlink" title="2.DailyTimeIntervalScheduleBuilder:根据时间定时执行"></a>2.DailyTimeIntervalScheduleBuilder:根据时间定时执行</h4><h4 id="3-SimpleScheduleBuilder-简单循环执行，设定执行次数，开始结束时间等"><a href="#3-SimpleScheduleBuilder-简单循环执行，设定执行次数，开始结束时间等" class="headerlink" title="3.SimpleScheduleBuilder:简单循环执行，设定执行次数，开始结束时间等"></a>3.SimpleScheduleBuilder:简单循环执行，设定执行次数，开始结束时间等</h4><h4 id="4-CronScheduleBuilder-cron表达式实现的定时执行"><a href="#4-CronScheduleBuilder-cron表达式实现的定时执行" class="headerlink" title="4.CronScheduleBuilder:cron表达式实现的定时执行"></a>4.CronScheduleBuilder:cron表达式实现的定时执行</h4><h3 id="6-cron表达式"><a href="#6-cron表达式" class="headerlink" title="6.cron表达式"></a>6.cron表达式</h3><p>Cron表达式用于配置CronTrigger的实例，由七个子表达式组成，用来描述详细的时间信息</p>
<p>格式<strong>[秒] [分] [时] [日] [月] [周] [年]</strong></p>
<p><img src="/2021/09/24/SpringBoot%E6%95%B4%E5%90%88Quartz/1.png" alt></p>
<table>
<thead>
<tr>
<th><strong>表达式</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody><tr>
<td>0 * * * * ？</td>
<td>每一分钟触发一次</td>
</tr>
<tr>
<td>0 0 10，14，16 * * ？</td>
<td>每天上午10点，下午2点，4点</td>
</tr>
<tr>
<td>0 0 5-15 * * ？</td>
<td>每天5点-15点整点触发</td>
</tr>
<tr>
<td>0 0 10 * * ？</td>
<td>每天10点触发一次</td>
</tr>
<tr>
<td>*/5 * * * * ？</td>
<td>每隔5秒执行一次</td>
</tr>
</tbody></table>
<h2 id="2-SpringBoot整合Quatz"><a href="#2-SpringBoot整合Quatz" class="headerlink" title="2.SpringBoot整合Quatz"></a>2.SpringBoot整合Quatz</h2><h3 id="1-创建BaseJob"><a href="#1-创建BaseJob" class="headerlink" title="1.创建BaseJob"></a>1.创建BaseJob</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.education.service.job;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.quartz.QuartzJobBean;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 余一</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/6/13 17:13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseJob</span> <span class="keyword">extends</span> <span class="title">QuartzJobBean</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-定义SystemJob继承BaseJob"><a href="#2-定义SystemJob继承BaseJob" class="headerlink" title="2.定义SystemJob继承BaseJob"></a>2.定义SystemJob继承BaseJob</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.education.service.job;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.quartz.JobExecutionContext;</span><br><span class="line"><span class="keyword">import</span> org.quartz.JobExecutionException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 余一</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/6/13 17:14</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SystemJob</span> <span class="keyword">extends</span> <span class="title">BaseJob</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">executeInternal</span><span class="params">(JobExecutionContext jobExecutionContext)</span> <span class="keyword">throws</span> JobExecutionException </span>&#123;</span><br><span class="line">        Date now = <span class="keyword">new</span> Date();</span><br><span class="line">        SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">        System.out.println(sdf.format(now));</span><br><span class="line">        System.out.println(<span class="string">"执行任务："</span>+SystemJob<span class="class">.<span class="keyword">class</span>.<span class="title">getSimpleName</span>())</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-创建JobBeanConfig"><a href="#3-创建JobBeanConfig" class="headerlink" title="3.创建JobBeanConfig"></a>3.创建JobBeanConfig</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.education.service.job;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.quartz.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> 余一</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2021/6/13 17:18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JobBeanConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_GROUP = <span class="string">"default_group"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建JobDetail对象</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JobDetail <span class="title">systemJob</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> JobBuilder.newJob(SystemJob<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">            .<span class="title">withIdentity</span>(<span class="title">SystemJob</span>.<span class="title">class</span>.<span class="title">getSimpleName</span>(),<span class="title">DEFAULT_GROUP</span>).<span class="title">storeDurably</span>().<span class="title">build</span>()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建任务触发器</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Trigger <span class="title">jobTrigger</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> TriggerBuilder.newTrigger().forJob(systemJob().getKey())</span><br><span class="line">                .withIdentity(SystemJob<span class="class">.<span class="keyword">class</span>.<span class="title">getSimpleName</span>(),<span class="title">DEFAULT_GROUP</span>)</span></span><br><span class="line">                .startNow().withSchedule(CronScheduleBuilder.cronSchedule("*/5 * * * * ?")).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动项目后就会执行定时任务</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hluck.github.io/2021/09/24/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%8A%80%E6%9C%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar5.jpg">
      <meta itemprop="name" content="余一">
      <meta itemprop="description" content="纸上得来终觉浅，绝知此事要躬行。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="余一">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/24/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%8A%80%E6%9C%AF/" class="post-title-link" itemprop="url">Java线程池技术</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-09-24 09:21:19 / 修改时间：09:34:57" itemprop="dateCreated datePublished" datetime="2021-09-24T09:21:19+08:00">2021-09-24</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>7.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-为什么要使用线程池？"><a href="#1-为什么要使用线程池？" class="headerlink" title="1.为什么要使用线程池？"></a>1.为什么要使用线程池？</h2><ul>
<li>减少了创建和销毁线程的次数，每个工作线程都可以被重复利用，可执行多个任务，降低了系统资源的消耗。</li>
</ul>
<h2 id="2-Web系统中使用多线程的场景"><a href="#2-Web系统中使用多线程的场景" class="headerlink" title="2.Web系统中使用多线程的场景"></a>2.Web系统中使用多线程的场景</h2><h3 id="主业务和子业务耦合度低"><a href="#主业务和子业务耦合度低" class="headerlink" title="主业务和子业务耦合度低"></a>主业务和子业务耦合度低</h3><p>如：发短信或发送邮件，请求第三方接口</p>
<h2 id="3-线程池的执行原理"><a href="#3-线程池的执行原理" class="headerlink" title="3.线程池的执行原理"></a>3.线程池的执行原理</h2><p><img src="/2021/09/24/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%8A%80%E6%9C%AF/27.png" alt></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/09/24/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%8A%80%E6%9C%AF/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="余一"
      src="/images/avatar5.jpg">
  <p class="site-author-name" itemprop="name">余一</p>
  <div class="site-description" itemprop="description">纸上得来终觉浅，绝知此事要躬行。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">171</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.bilibili.com/" title="https:&#x2F;&#x2F;www.bilibili.com&#x2F;" rel="noopener" target="_blank">Bilibili</a>
        </li>
    </ul>
  </div>

	
           
         
         <div style="">
  <canvas id="canvas" style="width:60%;">��ǰ�������֧��canvas������������������</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //����canvas�Ŀ���
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //�洢ʱ������
    var data = [];
    //�洢�˶���С��
    var balls = [];
    //�������Ӱ뾶
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //�洢ʱ�����֣���ʮλСʱ����λСʱ��ð�š�ʮλ���ӡ���λ���ӡ�ð�š�ʮλ���ӡ���λ������7���������
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*���ɵ�������*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*����ʱ��*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //ʱ�䷢���仯
            if(NewData[i] !== data[i]){
                //���仯������ֵ����data�����е������洢��changeNumArray������
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //����С��
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*����С��״̬*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*����Ҫ�˶���С��*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*��Ⱦ*/
    function render(){
        //���û������ȣ��ﵽ��ջ�����Ч��
        canvas.height = 100;
        //��Ⱦʱ��
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //��ȾС��
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //����ʱ��
        updateDigitTime();
        //����С��״̬
        updateBalls();
        //��Ⱦ
        render();
    },50);
}

})();
</script>
      </div>
	
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">余一</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.5m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">22:32</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div><script color="0,0,255" opacity="0.5" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1/dist/canvas-nest.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

  <script async src="/js/cursor/fireworks.js"></script>

</body>
</html>
